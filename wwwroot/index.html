<!DOCTYPE html>
<html>
<head>
    <title>Gamer's Remorse - Redefining The Metrics</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
    <style>
        :root {
            --color-positive: #54bebe;
            --color-negative: #c80064;
            --color-uncertain: #666666;
            --color-accent: #333333;
            /* Tag colors - positive */
            --color-tag-healthy: #2ecc71;
            --color-tag-honest: #27ae60;
            --color-tag-redemption: #228B22;
            --color-tag-phoenix: #FF4500;
            --color-tag-180: #228B22;
            --color-tag-surge: #00cc66;
            /* Tag colors - negative */
            --color-tag-extractive: #cc4400;
            --color-tag-predatory: #e74c3c;
            --color-tag-enshittified: #8B4513;  
            --color-tag-stockholm: #9b59b6;
            --color-tag-flop: #8B0000;
            --color-tag-troubled: #a08060;
            --color-tag-refund-trap: #c0392b;
            --color-tag-zombie: #2d5a27;
            --color-tag-rugpull: #8B0000;
            --color-tag-plague: #556B2F;
            --color-tag-cursed: #1a0d00;
            /* Tag colors - neutral/warning */
            --color-tag-divisive: #9932CC;
            --color-tag-honeymoon: #DAA520;
            --color-tag-addictive: #e67e22;
            --color-tag-cult: #8e44ad;
            --color-tag-horny: #ff69b4;
            /* Tag colors - state/meta */
            --color-tag-dead: #444;
            --color-tag-press-f: #666;
            --color-tag-hopeless: #708090;
            --color-tag-low-data: #999;
            --color-tag-corrupted: #666;
            --color-tag-review-bombed: #ff6600;
            --color-tag-revisionist: #8B4513;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background: #e5e5e5;
            font-family: Verdana, Arial, sans-serif;
            font-size: 11px;
            color: #333;
        }

        .header {
            background: var(--color-accent);
            padding: 10px 20px;
            display: flex;
            align-items: center;
            gap: 20px;
        }

            .header h1 {
                color: #fff;
                font-size: 22px;
                font-weight: bold;
            }

            .header .tagline {
                color: var(--color-positive);
                font-size: 9px;
            }

        .nav {
            background: #fff;
            border-bottom: 2px solid var(--color-accent);
            padding: 0 20px;
        }

            .nav a {
                display: inline-block;
                color: #333;
                text-decoration: none;
                padding: 8px 15px;
                font-size: 11px;
                border-right: 1px solid #ddd;
            }

                .nav a:hover {
                    background: #f0f0f0;
                }

        /* === THREE COLUMN LAYOUT === */
        .main {
            max-width: 1500px;
            margin: 15px auto;
            display: grid;
            grid-template-columns: 320px 1fr 320px;
            gap: 20px;
            padding: 0 20px;
        }

        .col-left {
            order: 1;
        }

        .col-center {
            order: 2;
        }

        .col-right {
            order: 3;
        }

        /* Mobile: stack with different order */
        @media (max-width: 1000px) {
            .main {
                grid-template-columns: 1fr;
            }

            .col-center {
                order: 1;
            }
            /* charts first */
            .col-left {
                order: 2;
            }
            /* methodology second */
            .col-right {
                order: 3;
            }
            /* opinion last */
        }

        /* === BOXES === */
        .box {
            background: #fff;
            border: 1px solid #ccc;
            margin-bottom: 15px;
        }

        .box-header {
            background: var(--color-accent);
            color: #fff;
            padding: 8px 12px;
            font-weight: bold;
            font-size: 10px;
            text-transform: uppercase;
        }

            .box-header.light {
                background: #f5f5f5;
                color: #555;
                border-bottom: 1px solid #ddd;
            }

        .box-body {
            padding: 12px;
            font-size: 11px;
            line-height: 1.6;
        }

            .box-body p {
                margin-bottom: 10px;
            }

                .box-body p:last-child {
                    margin-bottom: 0;
                }

            .box-body h3 {
                font-size: 11px;
                color: #555;
                text-transform: uppercase;
                margin: 15px 0 8px 0;
                padding-top: 10px;
                border-top: 1px solid #eee;
            }

                .box-body h3:first-child {
                    margin-top: 0;
                    padding-top: 0;
                    border-top: none;
                }

            .box-body strong {
                color: var(--color-accent);
            }

            .box-body em {
                font-style: italic;
            }

            .box-body ul {
                margin: 8px 0;
                padding-left: 18px;
            }

            .box-body li {
                margin: 4px 0;
            }

        /* === SEARCH === */
        .search-row {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
        }

        input[type="text"] {
            flex: 1;
            padding: 6px 8px;
            font-size: 11px;
            border: 1px solid #999;
            font-family: Verdana, Arial, sans-serif;
        }

        button {
            background: var(--color-accent);
            color: #fff;
            border: none;
            padding: 6px 15px;
            font-size: 10px;
            font-weight: bold;
            text-transform: uppercase;
            cursor: pointer;
            font-family: Verdana, Arial, sans-serif;
        }

            button:hover {
                background: #555;
            }

        /* === STATS & METRICS === */
        #stats {
            font-size: 11px;
            color: #666;
            margin-bottom: 10px;
        }

            #stats strong {
                color: #333;
            }

        #metrics-detail {
            margin: 10px 0;
            padding: 10px;
            background: #f9f9f9;
            border: 1px solid #ddd;
            font-size: 11px;
        }

        .verdict-tags {
            margin-bottom: 8px;
        }

        .tag-pill {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            color: white;
            font-size: 11px;
            font-weight: bold;
            margin-right: 5px;
            margin-bottom: 4px;
            text-shadow: 0 1px 1px rgba(0,0,0,0.3);
        }

        .reasons {
            margin: 8px 0;
            padding-left: 20px;
        }

            .reasons li {
                margin: 4px 0;
                color: #555;
            }

        .metrics-raw {
            font-size: 10px;
            color: #888;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #ddd;
        }

        #game-title {
            font-size: 14px;
            font-weight: bold;
            color: #333;
            margin: 10px 0;
        }

            #game-title:empty {
                display: none;
            }

        /* === CHARTS === */
        .chart-container {
            position: relative;
            background: #fafafa;
            border: 1px solid #ddd;
        }

        .chart-wrapper {
            position: relative;
            height: 350px;
        }

        #chart {
            width: 100%;
            height: 100%;
        }

        #eye {
            width: 120px;
            height: 80px;
        }

        #labels-container {
            position: absolute;
            bottom: -1.5em;
            left: 0;
            right: 0;
            height: 25px;
            pointer-events: none;
        }

        #timeline {
            width: 100%;
            height: 80px;
            display: block;
        }

        #timeline-range {
            text-align: center;
            font-size: 11px;
            color: #333;
            padding: 5px 0;
        }

        .chart-container.velocity {
            height: 250px;
            padding-bottom: 0;
        }

        .chart-container.language {
            height: 250px;
            padding-bottom: 0;
        }

        .chart-container.heatmap {
            height: 300px;
            padding: 10px;
            position: relative;
        }

        #edit-heatmap {
            width: 100%;
            height: 100%;
        }

        .heatmap-tooltip {
            display: none;
            position: absolute;
            background: rgba(0,0,0,0.85);
            color: white;
            padding: 6px 10px;
            border-radius: 3px;
            font-size: 10px;
            pointer-events: none;
            z-index: 100;
        }

        .controversy-section {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #ddd;
        }

        .controversy-section h4 {
            margin: 0 0 10px 0;
            font-size: 12px;
            color: #333;
        }

        .controversy-item {
            background: #f9f9f9;
            border-left: 3px solid var(--color-negative);
            padding: 8px 12px;
            margin-bottom: 10px;
            font-size: 11px;
        }

        .controversy-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .controversy-type {
            color: var(--color-negative);
        }

        .controversy-year {
            color: #666;
        }

        .controversy-text {
            color: #444;
            line-height: 1.5;
        }

        .chart-row {
            display: flex;
            gap: 20px;
        }

        .chart-half {
            flex: 1;
            min-width: 0;
        }

        .chart-title {
            font-size: 11px;
            color: #555;
            margin: 15px 0 8px 0;
        }

        .x-label {
            position: absolute;
            transform: translateX(-50%);
            color: #666;
            font-size: 9px;
        }

        .chart-controls {
            margin-bottom: 10px;
            font-size: 10px;
        }

            .chart-controls label {
                margin-right: 12px;
            }

        .verbosity-legend {
            margin: 8px 0;
            font-size: 10px;
            color: #666;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .verbosity-label {
            color: #555;
        }

        .verbosity-sample {
            display: inline-block;
            width: 12px;
            height: 24px;
            vertical-align: middle;
            margin-left: 8px;
            border-radius: 2px;
        }

        .verbosity-sample.short {
            background: linear-gradient(to bottom,
                var(--color-positive) 0%,
                var(--color-positive) 100%
            );
        }

        .verbosity-sample.long {
            background: linear-gradient(to bottom,
                var(--color-positive) 0%,
                var(--color-positive) 30%,
                color-mix(in srgb, var(--color-positive) 50%, black) 30%,
                color-mix(in srgb, var(--color-positive) 50%, black) 100%
            );
        }

        /* === OPINION SECTION === */
        .opinion-placeholder {
            padding: 20px;
            text-align: center;
            color: #999;
            font-style: italic;
        }

        .opinion-converging {
            opacity: 0.8;
        }

        .opinion-hint {
            color: #888;
            font-style: italic;
            font-size: 0.9em;
        }

        .opinion-verdict {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 2px solid #eee;
        }

            .opinion-verdict.healthy {
                color: var(--color-positive);
            }

            .opinion-verdict.caution {
                color: #cc8800;
            }

            .opinion-verdict.warning {
                color: var(--color-negative);
            }

        .opinion-breakdown {
            margin: 12px 0;
        }

            .opinion-breakdown dt {
                font-weight: bold;
                color: #555;
                margin-top: 10px;
            }

            .opinion-breakdown dd {
                margin: 4px 0 0 0;
                color: #666;
            }

        .opinion-tldr {
            background: #f5f5f5;
            padding: 10px;
            margin-top: 12px;
            border-left: 3px solid var(--color-accent);
        }

        /* === FOOTER === */
        .footer {
            text-align: center;
            padding: 15px;
            color: #888;
            font-size: 10px;
        }

            .footer a {
                color: var(--color-accent);
            }
    </style>
</head>
<body>
    <div class="header">
        <svg id="eye"></svg>
        <div>
            <h1>Gamer's Remorse</h1>
            <div class="tagline"><em>We are the metrics <strong>now</strong></em></div>
        </div>
    </div>

    <div class="nav">
        <a href="#">Analyze</a>
        <a href="#">Leaderboards</a>
        <a href="#">Wall of Shame</a>
        <a href="#">Healthy Games</a>
        <a href="#">About</a>
    </div>

    <div class="main">
        <!-- LEFT COLUMN: Methodology -->
        <div class="col-left">
            <div class="box">
                <div class="box-header">What Am I Looking At?</div>
                <div class="box-body">
                    <p>
                        This chart shows <strong>when</strong> players leave reviews.
                        X-axis is playtime (log scale), Y-axis is review count.
                    </p>
                    <p>
                        <strong style="color: var(--color-positive)">Blue</strong> = positive.
                        <strong style="color: var(--color-negative)">Pink</strong> = negative.
                        <strong style="color: var(--color-uncertain)">Gray</strong> = edited after a week (fence-sitters).
                    </p>

                    <h3>Healthy vs Extractive</h3>
                    <p>
                        <strong>Healthy:</strong> Negative reviews cluster early. People who won't like it figure that out fast.
                    </p>
                    <p>
                        <strong>Extractive:</strong> Negative reviews come <em>after</em> positive ones.
                        Players get burned after investing significant time.
                    </p>

                    <h3>The Median Lines</h3>
                    <p>
                        Dashed lines show median playtime for each sentiment.
                        When negative median sits <em>right</em> of positive, that's extraction.
                    </p>
                </div>
            </div>

            <div class="box">
                <div class="box-header">How do the tags work?</div>
                <div class="box-body">
                    <p>
                        TAGS are inferred from the shape of the charts and from the contents of the examined reviews.
                        They do not (necessarily) represent the opinions of the players, and they are not to be taken or shared as objective statements (unless sourced from reddit and adequately padded with weasel words).
                    </p>
                    <p>
                        The sampling algorithm does not strive to represent the current recommended/not recommended ratio faithfully; 
                        it tries to find as many different opinions as possible and then it weighs them against the nominal ratio when it makes sense to do so.
                    </p>
                    <p>
                        Some tags are mutually exclusive, and some tags can level up. For example, PREDATORY is a stronger version of EXTRACTIVE.
                        Gotta match 'em all.
                    </p>
                </div>
            </div>
        </div>

        <!-- CENTER COLUMN: Charts -->
        <div class="col-center">
            <div class="box">
                <div class="box-header light">Steam Review Analysis</div>
                <div class="box-body">
                    <div class="search-row">
                        <input type="text" id="appId" placeholder="Steam App ID or store URL">
                        <button onclick="analyze()">Analyze</button>
                    </div>
                    <h2 id="game-title"></h2>
                    <div id="stats"></div>
                    <div id="metrics-detail"></div>
                    <div class="chart-controls">
                        <label><input type="checkbox" id="hideAnomalies"> Hide anomalies</label>
                        <label><input type="checkbox" id="hideSpikes"> Hide bombs/brigades</label>
                        <label><input type="checkbox" id="hideAnnotations"> Hide annotations</label>
                        <label><input type="checkbox" id="showTotalTime"> Show total playtime</label>
                    </div>
                    <div class="chart-container">
                        <div class="chart-wrapper">
                            <canvas id="chart"></canvas>
                            <div id="labels-container"></div>
                        </div>
                        <div id="timeline-range"></div>
                        <canvas id="timeline"></canvas>
                    </div>
                    <div class="chart-row">
                        <div class="chart-half">
                            <h3 class="chart-title">How long do people keep playing after reviewing?</h3>
                            <div class="chart-container velocity">
                                <canvas id="velocity-chart"></canvas>
                            </div>
                        </div>
                        <div class="chart-half">
                            <h3 class="chart-title">How Creative Is Their Language?</h3>
                            <div class="chart-container language">
                                <canvas id="language-chart"></canvas>
                            </div>
                        </div>
                    </div>
                    <h3 class="chart-title">Who Changed Their Mind When?</h3>
                    <div class="chart-container heatmap">
                        <canvas id="edit-heatmap"></canvas>
                        <div id="heatmap-tooltip" class="heatmap-tooltip"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- RIGHT COLUMN: Opinion / So What -->
        <div class="col-right">
            <div class="box">
                <div class="box-header">How Do I Read The Charts?</div>
                <div class="box-body" id="opinion-content">
                    <p style="color: #999; font-style: italic;">
                        Analyze a game to see the verdict.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div class="footer">
        Made with 💊 by <a href="#">ritalin.js</a>
    </div>

    <script src="patterns.js"></script>
    <script src="metrics.js"></script>
    <script src="eye.js"></script>
    <script src="app.js"></script>
</body>
</html>
